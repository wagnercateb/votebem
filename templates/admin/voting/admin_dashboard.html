{% extends "admin/voting/base_administrativo.html" %}

{% block title %}Dashboard Administrativo - VoteBem{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active">Dashboard</li>
{% endblock %}

{% block extra_css %}
<style>
    .dashboard-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        margin-bottom: 15px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .dashboard-header h1 {
        margin: 0;
        font-size: 2em;
        font-weight: 400;
    }
    
    .dashboard-header p {
        margin: 8px 0 0 0;
        font-size: 1em;
        opacity: 0.9;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 12px;
        margin-bottom: 20px;
    }
    
    .stat-card {
        background: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        border-left: 3px solid #667eea;
        transition: transform 0.2s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-2px);
    }
    
    .stat-number {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
    }
    
    .stat-label {
        font-size: 0.9em;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .admin-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 15px;
    }
    
    .action-card {
        background: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        border-top: 3px solid #667eea;
    }
    
    .action-card h3 {
        margin: 0 0 12px 0;
        color: #333;
        font-size: 1.1em;
        font-weight: 600;
    }
    
    .action-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .action-list li {
        margin-bottom: 8px;
    }
    
    .action-list a {
        display: block;
        padding: 8px 12px;
        background: #f8f9fa;
        color: #333;
        text-decoration: none;
        border-radius: 4px;
        transition: all 0.2s ease;
        border-left: 2px solid transparent;
        font-size: 0.9em;
    }
    
    .action-list a:hover {
        background: #667eea;
        color: white;
        border-left-color: #4c63d2;
        transform: translateX(3px);
    }
</style>
{% endblock %}

{% block content %}

<div class="admin-actions">
    <div class="action-card">
        <h3>Proposições</h3>
        <ul class="action-list">
            <!-- Tooltip descreve ação e se é via App ou Django -->
            <li><a href="{% url 'gerencial:proposicoes_list' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Exibe a lista de proposições cadastradas no aplicativo">Listar Todas as Proposições</a></li>
            <!-- Link ajustado para manter o mesmo estilo dos demais itens -->
            <li>
                <a href="/gerencial/camara-admin/" data-bs-toggle="tooltip" data-bs-placement="top" title="Abre a página de importação/gerência em lote da Câmara">Adicionar em lote, por período</a>
            </li>
            <li><a href="{% url 'gerencial:proposicoes_statistics' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Mostra métricas e estatísticas das proposições">Estatísticas de Proposições</a></li>
            <li><a href="/admin/voting/proposicao/add/" data-bs-toggle="tooltip" data-bs-placement="top" title="Abre o formulário de criação no Django Admin">Adicionar via Django</a></li>
            <li><a href="{% url 'gerencial:proposicao_add' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Abre o formulário de criação de proposição no aplicativo">Adicionar uma manualmente</a></li>
            <!-- Link ajustado para manter o mesmo estilo dos demais itens -->
            <li>
                <a href="{% url 'gerencial:proposicoes_atualizar_temas' %}"
                   data-bs-toggle="tooltip"
                   data-bs-placement="top"
                   title="Busca e vincula temas oficiais para proposições sem temas">
                    Atualizar temas de proposições
                </a>
            </li>
            <li><a href="{% url 'gerencial:proposicao_import' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Importa uma proposição informando o ID da Câmara">Adicionar via ID</a></li>
            <li><a href="{% url 'gerencial:proposicao_edit_choose' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Editar uma proposição existente pelo ID">Editar uma proposição</a></li>
        </ul>
    </div>
    
    <div class="action-card">
        <h3>Votações Votebem</h3>
        <ul class="action-list">
            <li><a href="{% url 'gerencial:votacoes_management' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Ativa, pausa ou encerra votações no aplicativo">Votações Cadastradas</a></li>
            <li><a href="{% url 'gerencial:proposicao_votacoes_management' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista votações oficiais vinculadas às proposições">VotacaoProposicao cadastradas</a></li>
            {# Novo botão: abre a ferramenta RAG em uma aba/target separado #}
            <li><a href="{% url 'gerencial:rag_tool' %}" target="_rag" data-bs-toggle="tooltip" data-bs-placement="top" title="Abre ferramenta RAG (sem LangChain) com PDFs e Markdown">RAG de notícias</a></li>
            <li><a href="/admin/voting/votacaovotebem/" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista todas as votações disponíveis no Django Admin">Listar Todas as Votações via Django</a></li>
            <li><a href="/admin/voting/votacaovotebem/add/" data-bs-toggle="tooltip" data-bs-placement="top" title="Cria uma nova votação pelo Django Admin">Criar Nova Votação via Django</a></li>
        </ul>
    </div>

    <div class="action-card">
        <h3>Votações oficiais</h3>
        <ul class="action-list">
            <li><a href="{% url 'gerencial:votacoes_oficiais_list' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista Votações oficiais já obtidas, com ou sem votos individuais">Listar votações oficiais, obter por ano</a></li>
            <li><a href="{% url 'gerencial:votos_oficiais_app' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Obtem uma ou mais votações oficiais usando API da Câmara">Obter votação por proposicao_id via App</a></li>
            <li><a href="{% url 'gerencial:votacoes_por_periodo' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Abre a tela para obter votações por período na Câmara API">Obter votações por período</a></li>
            <li><a href="/admin/voting/congressmanvote/" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista Votação oficial no Django Admin">Votos individuais oficiais via Django</a></li>
        </ul>
    </div>

    
    <div class="action-card">
        <h3>Usuários</h3>
        <ul class="action-list">
            <li><a href="/admin/auth/user/" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista todos os usuários no Django Admin">Listar Todos os Usuários via Django</a></li>
            <li><a href="{% url 'gerencial:users_management' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Exibe estatísticas e atividade de usuários no aplicativo">Estatísticas de Usuários</a></li>
            <li><a href="/admin/users/userprofile/" data-bs-toggle="tooltip" data-bs-placement="top" title="Gerencia perfis de usuários no Django Admin">Perfis de Usuários via Django</a></li>
        </ul>
    </div>
    
    <div class="action-card">
        <h3>Congressistas</h3>
        <ul class="action-list">
            <li><a href="/admin/voting/congressman/" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista deputados no Django Admin">Deputados via Django</a></li>
            <li><a href="/admin/voting/congressman/add/" data-bs-toggle="tooltip" data-bs-placement="top" title="Cria um novo deputado pelo Django Admin">Adicionar Congressista via Django</a></li>
            <li><a href="{% url 'gerencial:congressistas_update' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Atualiza cadastro de deputados com dados da API da Câmara">Atualizar Deputados (Câmara API)</a></li>
        </ul>
    </div>
    
    <div class="action-card">
        <h3>Ferramentas de Dados</h3>
        <ul class="action-list">
            <li><a href="{% url 'gerencial:data_import_export' %}" data-bs-toggle="tooltip" data-bs-placement="top" title="Importa ou exporta dados do sistema pelo aplicativo">Importar/Exportar Dados</a></li>
            <li><a href="/admin/voting/voto/" data-bs-toggle="tooltip" data-bs-placement="top" title="Analisa votos populares no Django Admin">Analisar Votos Populares via Django</a></li>
        </ul>
    </div>
    
    <!-- <div class="action-card">
        <h3>Enquetes</h3>
        <ul class="action-list">
            <li><a href="/admin/polls/enquete/" data-bs-toggle="tooltip" data-bs-placement="top" title="Lista e edita enquetes no Django Admin">Enquetes via Django</a></li>
            <li><a href="/admin/polls/respostaenquete/" data-bs-toggle="tooltip" data-bs-placement="top" title="Visualiza respostas de enquetes no Django Admin">Respostas de Enquetes via Django</a></li>
            <li><a href="/admin/polls/enquete/add/" data-bs-toggle="tooltip" data-bs-placement="top" title="Cria nova enquete pelo Django Admin">Criar Nova Enquete via Django</a></li>
        </ul>
    </div> -->

</div>


<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number">{{ total_proposicoes }}</div>
        <div class="stat-label">Proposições</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_votacoes_disponiveis }}</div>
        <div class="stat-label">Votações Criadas</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ votacoes_ativas }}</div>
        <div class="stat-label">Votações Ativas</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_votos_populares }}</div>
        <div class="stat-label">Votos Populares</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_congressistas }}</div>
        <div class="stat-label">Congressistas</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_votos_congressistas }}</div>
        <div class="stat-label">Votação oficial</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_usuarios }}</div>
        <div class="stat-label">Usuários</div>
    </div>
</div>


{# Panels removed per request to avoid extra DB loads #}

{% block extra_js %}
<script>
  // Inicializa tooltips do Bootstrap em todos os elementos com data-bs-toggle="tooltip"
  document.addEventListener('DOMContentLoaded', function () {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.forEach(function (tooltipTriggerEl) {
      new bootstrap.Tooltip(tooltipTriggerEl);
    });
  });
</script>
{% endblock %}
{% endblock %}
